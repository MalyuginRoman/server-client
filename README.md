Техническое задание


Реализовать микросервисную архитектуру многопользовательского приложения "Космический бой".


Требуемый функционал:
1. Космические корабли могут:
   - двигаться вперед-назад;
   - поворачиваться;
   - стрелять;
   - останавливаться.
3. При движении и стрельбе обрабатываются коллизии.
4. Определение кто выиграл.
5. Прием команд от игрока.
6. Псевдопараллельный игровой сервер.


Реализация


Принятый правила проведения космического боя:
- Размер игрового поля 100х100;
- Игроки осуществляют действия поочередно в течение 100 игровых раундов;
- Максимальное число игроков в одном бое равно 5, у каждого по 1-му кораблю;
- Исходное положение игроков фиксировано;
- Объекты вышедшие за пределы игрового поля удаляются;
- После столкновения объекты удаляются;
- Максимальная скорость корабля ограничена 15 [ед. длины / ед. времени];
- Выстрел осуществляется только в движении, количество выстрелов не ограничено;
- Каждому кораблю в начале боя выдается 100 ед. топлива;
- На движение и выстрел тратится по 1 ед. топлива.

Ограничение количества кораблей под управлением игрока 1 шт. связано с принятой парадигмой взаимодействия игрока с сервером.
Сервер информирует игрока о том какую информацию от него ожидает, игрок в текстовом виде через консоль отправляет запрашиваемую информацию.
Увеличение количества кораблей привело бы к необходимости указывать какому конкретно кораблю отдается та или иная команда.
Вариантом решения может быть использование пользовательского интерфейса (не является обязательным требованием при выполнении проектной работы) или отправка пакета команд в той или иной форме для всех кораблей разом, что значительно повысило бы трудозатраты на реализацию (что неприемлемо в связи с временными ограничениями на выполнение проектна).


Доступные команды для управления кораблем:
- StartMove (начать движение с заданной игроком скоростью);
- Go (продолжать движение с текущей скоростью);
- Rotate (поворот корабля на заданный игроком угол);
- StopMove (прекратить движения, т.е. обнулить текущую скорость корабля);
- Shoot (выстрел, после него к объектам игрока, корабль которого произвел выстрел, добавляется ракета, ее скорость на 5 ед. выше, чем у выстрелившего корабля);
- None (пауза, т.е. корабль не осуществляет никаких активных действий, не движется).


Определение победителя:
Подеждает игрок чьи объекта (корабль, ракеты) дольше продержатся на игровом поле.
В случае если в рамках одного раунда все игроки останутся без подконтрольных (космические корабли) и безконтрольных (ракеты) объектов в игре будет объявлена ничья.


Алгоритмическая сложность операций (n - кооличество объектов на игровом поле):
1. Обработка комманд о(n).
   
   Игровой сервер ожидает пока всеми игроками, участвующими в битве, будут отданы команды.
   После этого все комадны выполняются поочередно.
2. Проверка выхода объекта за пределы игрового поля о(n).
   
   После выполнения каждой из команд проверяется не вышлм ли корабль или ракеты игрока за пределы игрового поля.
   В случае если это происходит - они удаляются.
   При движении объектов отслеживается их расположение в двух системах координат (системы координат имеют различную длину шага по координатам абсцисс и ординат).
   Каждая система координат имеет набор сегментов с информацией о наличии в ней объектов. Если при движении объект покидает один из сегментов и попадает в другой, информация об этом фиксируется.
3. Проверка коллизий о(n).
   
   При движении объектов возможно три варианта столкновений: корабль-корабль, ракета-корабль, ракета-ракета.
   В конце каждого раунда происходит проверка происходили ли столкновения. Столкновением считается нахождение двух объектов в одной точке игрового пространства.
   Пересечение траекторий двух объектов не считается столкновением, если в конце раунда координаты расположения объектов отличаются.
   Для корректного учета столкновений необходимо было бы в случае пересечения траекторий двух объектов дробить шаг по времени на более мелкие фрагменты, чтобы отследить находились ли они в одно время в одной точке пространства (все объекта считаются материальными точкамии, не имеющими такого параметра как размер или габариты).

Игровой сервер и сервер авторизации работают в однопоточном режиме.
Сервер авторизации обрабатывает запросы подключающихся игроков по очереди.
Имена игроков и их пароли заранее определены, в случае если логин или пароль будут введены не верно игроку будет предложено ввести их повторно.
Игровой север ожидает подключения всех игроков, участвующих в данном игровом бое, после чего будет принимать от них команды также поочередно.
При этом в процессе формирования (ожидания подключения игроков) может одновременно находиться несколько бое.
Использование многопоточной архитектуры не являелось обязательным и увеличило бы трудозатраты на реализацию и отладку.
